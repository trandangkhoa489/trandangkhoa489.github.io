
 <krpano> 
 <action name="do_crop_animation" scope="local" args="framewidth, frameheight, framerate">
		<!-- define local variables -->
		calc(local.xframes, (caller.imagewidth /framewidth) BOR 0);
		calc(local.frames, xframes * ((caller.imageheight / frameheight) BOR 0));
		def(local.frame, integer, 0);
		
		<!-- set the first frame -->
		calc(caller.crop, '0|0|' + framewidth + '|' + frameheight);
		
		<!-- do the animation -->
		setinterval(calc('crop_anim_' + caller.name), calc(1.0 / framerate),
			if(caller.loaded,
				inc(frame);
				if(frame GE frames, if(caller.onlastframe !== null, callwith(caller, onlastframe() ) ); set(frame,0); );
				mod(xpos, frame, xframes);
				div(ypos, frame, xframes);
				Math.floor(ypos);
				mul(xpos, framewidth);
				mul(ypos, frameheight);
				calc(caller.crop, xpos + '|' + ypos + '|' + framewidth + '|' + frameheight);
			  ,
				<!-- stop the interval when the hotspot gets removed -->
				clearinterval(calc('crop_anim_' + caller.name));
			);
		);

</action>

<action name="add_all_the_time_tooltip">
	txtadd(tooltipname, 'tooltip_', get(name));
    addplugin(get(tooltipname));
    txtadd(plugin[get(tooltipname)].parent, 'hotspot[', get(name), ']');
    set(plugin[get(tooltipname)].url,'%SWFPATH%/plugins/textfield.swf');
    set(plugin[get(tooltipname)].align,top);
    set(plugin[get(tooltipname)].edge,bottom);
    set(plugin[get(tooltipname)].x,0);
    set(plugin[get(tooltipname)].y,0);
    set(plugin[get(tooltipname)].width,200);
    set(plugin[get(tooltipname)].autoheight,true);
    set(plugin[get(tooltipname)].background,false);
    set(plugin[get(tooltipname)].border,false);
    set(plugin[get(tooltipname)].css,'text-align:center; color:#FFFFFF; font-family:Arial; font-weight:bold; font-size:20px;');
    set(plugin[get(tooltipname)].textshadow,1);
    set(plugin[get(tooltipname)].textshadowrange,6.0);
    set(plugin[get(tooltipname)].textshadowangle,90);
    copy(plugin[get(tooltipname)].html,scene[get(linkedscene)].title);
    set(plugin[get(tooltipname)].enabled,false);
</action>

<action name="add_all_the_time_tooltip2">
	txtadd(tooltipname, 'tooltip_', get(name));
    addplugin(get(tooltipname));
    txtadd(plugin[get(tooltipname)].parent, 'hotspot[', get(name), ']');
    set(plugin[get(tooltipname)].url,'%SWFPATH%/plugins/textfield.swf');
    set(plugin[get(tooltipname)].align,top);
    set(plugin[get(tooltipname)].edge,bottom);
    set(plugin[get(tooltipname)].x,0);
    set(plugin[get(tooltipname)].y,0);
    set(plugin[get(tooltipname)].width,200);
    set(plugin[get(tooltipname)].autoheight,true);
    set(plugin[get(tooltipname)].background,false);
    set(plugin[get(tooltipname)].border,false);
    set(plugin[get(tooltipname)].css,'text-align:center; color:#FFFFFF; font-family:Arial; font-weight:bold; font-size:20px;');
    set(plugin[get(tooltipname)].textshadow,1);
    set(plugin[get(tooltipname)].textshadowrange,6.0);
    set(plugin[get(tooltipname)].textshadowangle,90);
    copy(plugin[get(tooltipname)].html,scene[get(linkedscene)].title);
    set(plugin[get(tooltipname)].enabled,false);
</action>

<action name="add_all_the_time_tooltip123">
	    txtadd(tooltipname, 'tooltip_', get(name));
	    addplugin(get(tooltipname));
	    txtadd(plugin[get(tooltipname)].parent, 'hotspot[', get(name), ']');
	    set(plugin[get(tooltipname)].url,'%SWFPATH%/plugins/textfield.swf');
	    set(plugin[get(tooltipname)].align,center);
	    set(plugin[get(tooltipname)].edge,left);
	    set(plugin[get(tooltipname)].x,5);
	    set(plugin[get(tooltipname)].y,0);
	    set(plugin[get(tooltipname)].autowidth,true);
	    set(plugin[get(tooltipname)].autoheight,true);
	    set(plugin[get(tooltipname)].vcenter,true);
	    set(plugin[get(tooltipname)].background,true);
	    set(plugin[get(tooltipname)].backgroundcolor,0xFFFFFF);
	    set(plugin[get(tooltipname)].roundedge,50);
	    set(plugin[get(tooltipname)].backgroundalpha,0.7);
	    set(plugin[get(tooltipname)].padding,2 2 2 4);
	    set(plugin[get(tooltipname)].border,false);
	    set(plugin[get(tooltipname)].glow,0);
	    set(plugin[get(tooltipname)].glowcolor,0xFFFFFF);
	    set(plugin[get(tooltipname)].origin,bottom);
	    set(plugin[get(tooltipname)].css,'text-align:center; color:#000000; font-family: Montserrat; font-weight:400;  font-size:12px;');
	    if(device.mobile,set(plugin[get(tooltipname)].css,'text-align:center; color:#000000; font-family:arial; font-weight:bold; font-size:7px;');
	    	);
	    set(plugin[get(tooltipname)].textshadow,0.00);
	    set(plugin[get(tooltipname)].textshadowrange,0);
	    set(plugin[get(tooltipname)].textshadowangle,0);
	    if(text == '' OR text === null,
	    copy(plugin[get(tooltipname)].html,scene[get(linkedscene)].title),
	    copy(plugin[get(tooltipname)].html,text)
	    );    
	    set(plugin[get(tooltipname)].enabled,false);
</action>

<action name="add_all_the_time_tooltip1234">
	    txtadd(tooltipname, '', get(name));
	    addplugin(get(tooltipname));
	    txtadd(plugin[get(tooltipname)].parent, 'hotspot[', get(name), ']');
	    set(plugin[get(tooltipname)].url,'%SWFPATH%/plugins/textfield.swf');
	    set(plugin[get(tooltipname)].align,center);
	    set(plugin[get(tooltipname)].edge,left);
	    set(plugin[get(tooltipname)].x,5);
	    set(plugin[get(tooltipname)].onclick,click());
		set(plugin[get(tooltipname)].onclick2,loadscene(get(name),null,MERGE,OPENBLEND(1.0, 0.0, 0.2, 0.0, linear)));
	    set(plugin[get(tooltipname)].y,0);
	    set(plugin[get(tooltipname)].autowidth,true);
	    set(plugin[get(tooltipname)].autoheight,true);
	    set(plugin[get(tooltipname)].vcenter,true);
	    set(plugin[get(tooltipname)].background,true);
	    set(plugin[get(tooltipname)].backgroundcolor,0xFFFFFF);
	    set(plugin[get(tooltipname)].roundedge,50);
	    set(plugin[get(tooltipname)].backgroundalpha,0.8);
	    set(plugin[get(tooltipname)].padding,2 5 2 4);
	    set(plugin[get(tooltipname)].border,false);
	    set(plugin[get(tooltipname)].glow,0);
	    set(plugin[get(tooltipname)].glowcolor,0xFFFFFF);
	    set(plugin[get(tooltipname)].origin,bottom);
	    set(plugin[get(tooltipname)].css,'text-align:center; color:#000000; font-family: Montserrat; font-weight:500; font-size:14px;');
	    if(device.mobile,set(plugin[get(tooltipname)].css,'text-align:center; color:#000000; font-family:arial; font-weight:bold; font-size:13px;');
	    	);

	    set(plugin[get(tooltipname)].textshadow,0.00);
	    set(plugin[get(tooltipname)].textshadowrange,0);
	    set(plugin[get(tooltipname)].textshadowangle,0);
	    if(text == '' OR text === null,
	    copy(plugin[get(tooltipname)].html,scene[get(linkedscene)].title),
	    copy(plugin[get(tooltipname)].html,text)
	    );    
	    set(plugin[get(tooltipname)].enabled,true);

</action>
<action name="click">
looktohotspot(get(name),get(view.fov));
					,
					set(enabled,false);
                    select_hs();
					lookto(get(hotspot[get(name)].ath),get(hotspot[get(name)].atv),get(view.fovmin),smooth(100,-100,120),true,false);
                    WAIT();                 
                    onclick2()); 
</action>
<action name="add_all_the_time_tooltip12345">
	    txtadd(tooltipname, '', get(name));
	    addplugin(get(tooltipname));
	    txtadd(plugin[get(tooltipname)].parent, 'hotspot[', get(name), ']');
	    set(plugin[get(tooltipname)].url,'%SWFPATH%/plugins/textfield.swf');
	    set(plugin[get(tooltipname)].align,center);
	    set(plugin[get(tooltipname)].edge,left);
	    set(plugin[get(tooltipname)].x,10);
	    set(plugin[get(tooltipname)].onclick,click());
		set(plugin[get(tooltipname)].onclick2,loadscene(get(name),null,MERGE,OPENBLEND(1.0, 0.0, 0.2, 0.0, linear)));
	    set(plugin[get(tooltipname)].y,0);
	    set(plugin[get(tooltipname)].autowidth,true);
	    set(plugin[get(tooltipname)].autoheight,true);
	    set(plugin[get(tooltipname)].vcenter,true);
	    set(plugin[get(tooltipname)].background,true);
	    set(plugin[get(tooltipname)].backgroundcolor,0x000000);
	    set(plugin[get(tooltipname)].roundedge,50);
	    set(plugin[get(tooltipname)].backgroundalpha,0.4);
	    set(plugin[get(tooltipname)].padding,2 2 2 17);
	    set(plugin[get(tooltipname)].border,false);
	    set(plugin[get(tooltipname)].glow,0);
	    set(plugin[get(tooltipname)].glowcolor,0xFFFFFF);
	    set(plugin[get(tooltipname)].origin,bottom);
	    set(plugin[get(tooltipname)].css,'text-align:center; color:#ffffff; font-family:Montserrat;font-weight:300;  font-size:14px;');
	    if(device.mobile,set(plugin[get(tooltipname)].css,'text-align:center; color:#000000; font-family:arial; font-weight:bold; font-size:13px;');
	    	);

	    set(plugin[get(tooltipname)].textshadow,0.00);
	    set(plugin[get(tooltipname)].textshadowrange,0);
	    set(plugin[get(tooltipname)].textshadowangle,0);
	    if(text == '' OR text === null,
	    copy(plugin[get(tooltipname)].html,scene[get(linkedscene)].title),
	    copy(plugin[get(tooltipname)].html,text)
	    );    
	    set(plugin[get(tooltipname)].enabled,true);

</action>


<action name="add_all_the_time_tooltip123456">
	    txtadd(tooltipname, '', get(name));
	    addplugin(get(tooltipname));
	    txtadd(plugin[get(tooltipname)].parent, 'hotspot[', get(name), ']');
	    set(plugin[get(tooltipname)].url,'%SWFPATH%/plugins/textfield.swf');
	    set(plugin[get(tooltipname)].align,center);
	    set(plugin[get(tooltipname)].edge,center);
	    set(plugin[get(tooltipname)].x,0);
	    set(plugin[get(tooltipname)].onclick,click());
		set(plugin[get(tooltipname)].onclick2,loadscene(get(name),null,MERGE,OPENBLEND(1.0, 0.0, 0.2, 0.0, linear)));
	    set(plugin[get(tooltipname)].y,0);
	    set(plugin[get(tooltipname)].width,500);
	    set(plugin[get(tooltipname)].height,50);
	    set(plugin[get(tooltipname)].vcenter,true);
	    set(plugin[get(tooltipname)].background,false);
	    set(plugin[get(tooltipname)].backgroundcolor,0x000000);
	    set(plugin[get(tooltipname)].roundedge,50);
	    set(plugin[get(tooltipname)].backgroundalpha,1);
	    set(plugin[get(tooltipname)].padding,2 2 2 17);
	    set(plugin[get(tooltipname)].border,false);
	    set(plugin[get(tooltipname)].glow,0);
	    set(plugin[get(tooltipname)].glowcolor,0xFFFFFF);
	    set(plugin[get(tooltipname)].origin,bottom);
	    set(plugin[get(tooltipname)].css,'text-align:center; color:#ffffff; font-family:arial;font-weight:600;  font-size:20px;');
	    if(device.mobile,set(plugin[get(tooltipname)].css,'text-align:center; color:#FFFFFF; font-family:arial; font-weight:bold; font-size:13px;');
	    	);

	    set(plugin[get(tooltipname)].textshadow,0.01);
	    set(plugin[get(tooltipname)].textshadowrange,3);
	    set(plugin[get(tooltipname)].textshadowangle,90);
	    if(text == '' OR text === null,
	    copy(plugin[get(tooltipname)].html,scene[get(linkedscene)].title),
	    copy(plugin[get(tooltipname)].html,text)
	    );    
	    set(plugin[get(tooltipname)].enabled,false);

</action>


<action name="add_all_the_time_tooltip_tt">
	    txtadd(tooltipname, '', get(name));
	    addplugin(get(tooltipname));
	    txtadd(plugin[get(tooltipname)].parent, 'hotspot[', get(name), ']');
	    set(plugin[get(tooltipname)].url,'%SWFPATH%/plugins/textfield.swf');
	    set(plugin[get(tooltipname)].align,center);
	    set(plugin[get(tooltipname)].edge,left);
	    set(plugin[get(tooltipname)].x,14);
	    set(plugin[get(tooltipname)].onclick,click());
		set(plugin[get(tooltipname)].onclick2,loadscene(get(name),null,MERGE,OPENBLEND(1.0, 0.0, 0.2, 0.0, linear)));
	    set(plugin[get(tooltipname)].y,0);
	    set(plugin[get(tooltipname)].autowidth,true);
	    set(plugin[get(tooltipname)].autoheight,true);
	    set(plugin[get(tooltipname)].vcenter,true);
	    set(plugin[get(tooltipname)].background,true);
	    set(plugin[get(tooltipname)].backgroundcolor,0xFFFFFF);
	    set(plugin[get(tooltipname)].roundedge,50);
	    set(plugin[get(tooltipname)].backgroundalpha,0.85);
	    set(plugin[get(tooltipname)].padding,2 7 2 7);
	    set(plugin[get(tooltipname)].border,false);
	    set(plugin[get(tooltipname)].glow,0);
	    set(plugin[get(tooltipname)].glowcolor,0xFFFFFF);
	    set(plugin[get(tooltipname)].origin,bottom);
	    set(plugin[get(tooltipname)].css,'text-align:center; color:#000000; font-family: Montserrat; font-weight:500; font-size:14px;');
	    if(device.mobile,set(plugin[get(tooltipname)].css,'text-align:center; color:#000000; font-family:arial; font-weight:bold; font-size:13px;');
	    	);

	    set(plugin[get(tooltipname)].textshadow,0.00);
	    set(plugin[get(tooltipname)].textshadowrange,0);
	    set(plugin[get(tooltipname)].textshadowangle,0);
	    if(text == '' OR text === null,
	    copy(plugin[get(tooltipname)].html,scene[get(linkedscene)].title),
	    copy(plugin[get(tooltipname)].html,text)
	    );    
	    set(plugin[get(tooltipname)].enabled,true);

</action>

<action name="add_all_the_time_tooltip_left">
	    txtadd(tooltipname, '', get(name));
	    addplugin(get(tooltipname));
	    txtadd(plugin[get(tooltipname)].parent, 'hotspot[', get(name), ']');
	    set(plugin[get(tooltipname)].url,'%SWFPATH%/plugins/textfield.swf');
	    set(plugin[get(tooltipname)].align,center);
	    set(plugin[get(tooltipname)].edge,right);
	    set(plugin[get(tooltipname)].x,-5);
	    set(plugin[get(tooltipname)].onclick,click());
		set(plugin[get(tooltipname)].onclick2,loadscene(get(name),null,MERGE,OPENBLEND(1.0, 0.0, 0.2, 0.0, linear)));
	    set(plugin[get(tooltipname)].y,0);
	    set(plugin[get(tooltipname)].autowidth,true);
	    set(plugin[get(tooltipname)].autoheight,true);
	    set(plugin[get(tooltipname)].vcenter,true);
	    set(plugin[get(tooltipname)].background,true);
	    set(plugin[get(tooltipname)].backgroundcolor,0xFFFFFF);
	    set(plugin[get(tooltipname)].roundedge,50);
	    set(plugin[get(tooltipname)].backgroundalpha,0.8);
	    set(plugin[get(tooltipname)].padding,2 2 2 5);
	    set(plugin[get(tooltipname)].border,false);
	    set(plugin[get(tooltipname)].glow,0);
	    set(plugin[get(tooltipname)].glowcolor,0xFFFFFF);
	    set(plugin[get(tooltipname)].origin,bottom);
	    set(plugin[get(tooltipname)].css,'text-align:center; color:#000000; font-family: Montserrat; font-weight:500; font-size:14px;');
	    if(device.mobile,set(plugin[get(tooltipname)].css,'text-align:center; color:#000000; font-family:arial; font-weight:bold; font-size:13px;');
	    	);

	    set(plugin[get(tooltipname)].textshadow,0.00);
	    set(plugin[get(tooltipname)].textshadowrange,0);
	    set(plugin[get(tooltipname)].textshadowangle,0);
	    if(text == '' OR text === null,
	    copy(plugin[get(tooltipname)].html,scene[get(linkedscene)].title),
	    copy(plugin[get(tooltipname)].html,text)
	    );    
	    set(plugin[get(tooltipname)].enabled,true);

</action>

<action name="add_all_the_time_tooltip_fix26">
	txtadd(tooltipname, 'tooltip_', get(name));
    addplugin(get(tooltipname));
    txtadd(plugin[get(tooltipname)].parent, 'hotspot[', get(name), ']');
    set(plugin[get(tooltipname)].url,'%SWFPATH%/plugins/textfield.swf');
    set(plugin[get(tooltipname)].align,top);
    set(plugin[get(tooltipname)].edge,bottom);
    set(plugin[get(tooltipname)].x,0);
    set(plugin[get(tooltipname)].y,0);
    set(plugin[get(tooltipname)].width,680);
    set(plugin[get(tooltipname)].autoheight,true);
    set(plugin[get(tooltipname)].background,false);
    set(plugin[get(tooltipname)].border,false);
    set(plugin[get(tooltipname)].css,'text-align:center; color:#000000; font-family:Arial; font-weight:bold; font-size:75px;background:#ffffff75;');
    set(plugin[get(tooltipname)].textshadow,1);
    set(plugin[get(tooltipname)].textshadowrange,6.0);
    set(plugin[get(tooltipname)].textshadowangle,90);
    copy(plugin[get(tooltipname)].html,scene[get(linkedscene)].title);
    set(plugin[get(tooltipname)].enabled,false);
</action>


<hotspot name="spot1" url="animatedhotspot_white.png" onloaded="do_crop_animation(64,64, 60);"   ath="-15" atv="-12" onclick="looktohotspot(get(name),65);" />
	<hotspot name="spot2" url="animatedhotspot_black.png" onloaded="do_crop_animation(64,64, 60);"   ath="+15" atv="+12" onclick="looktohotspot(get(name),65);" />
	<hotspot name="spot3" url="explosion.png"             onloaded="do_crop_animation(100,100, 60)"  ath="calc:random*90- 45" atv="calc:random*60 - 30" zoom="true" enabled="false" onlastframe="calc(ath, random*90-45); calc(atv, random*60-30);" />
	<hotspot name="spot4" url="circle.png"                onloaded="do_crop_animation(102,102, 60)"  ath="0" atv="0" enabled="false" />
	<hotspot name="spot5" url="target.png"                onloaded="do_crop_animation(128,128, 60);" ath="+15" atv="-12" onclick="looktohotspot(get(name),65);" scale="0.40" zoom="true" />
	<hotspot name="spot6" url="waves.png"                 onloaded="do_crop_animation(128,128, 15);" ath="0"   atv="-12" onclick="looktohotspot(get(name),65);" scale="0.25" zoom="true" />
	<hotspot name="spot7" url="arrow.png"                 onloaded="do_crop_animation(64,64, 60);"   ath="-15" atv="+12" onclick="looktohotspot(get(name),65);" />
	
	</krpano>